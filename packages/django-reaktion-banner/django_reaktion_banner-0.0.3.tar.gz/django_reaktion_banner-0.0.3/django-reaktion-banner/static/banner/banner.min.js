const isInViewport=function(e){if("none"!=getComputedStyle(e).display){e=e.getBoundingClientRect();return 0<=e.top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}},postToBackend=(e,n,t)=>{var o=document.getElementsByName("csrfmiddlewaretoken")[0].value;window.fetch(`${API_ENDPOINT}/${n}/${e}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":o},body:JSON.stringify(t)}).then(e=>e.json()).catch(e=>{console.log("ajax error",e)})};function init_ads(){let o=[],i;i=document.getElementsByClassName("banner-box"),0==i.length&&(i=document.getElementsByClassName("banner-box"));const l=window.location.href.split("?")[0],e=()=>{for(var e of i){var n,t;isInViewport(e)&&0==o.includes(e)&&(n=e.getAttribute("banner-id"),t={url:l},postToBackend("view",n,t),o.push(e))}};(()=>{for(var e of i)e.onclick=function(){let n=this.getAttribute("banner-url");var e=this.getAttribute("banner-id"),t={url:window.location.href};postToBackend("click",e,t),setTimeout(function(){let e=window.open(n,"_blank");e.focus()},500)}})(),e(),document.addEventListener("scroll",function(){console.log("ads len",i.length),console.log("trigger len",o.length),o.length!=i.length&&e()},{passive:!0})}document.addEventListener("DOMContentLoaded",function(){init_ads()});