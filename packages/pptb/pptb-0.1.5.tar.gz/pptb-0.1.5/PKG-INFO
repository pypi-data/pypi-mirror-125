Metadata-Version: 2.1
Name: pptb
Version: 0.1.5
Summary: ğŸš£ ä¸€äº›å¸¸ç”¨çš„ä½† paddle é‡Œæ²¡æœ‰çš„å°å·¥å…·ï½
Home-page: https://github.com/cattidea/paddle-toolbox
License: MIT
Keywords: python,paddle,toolbox
Author: Nyakku Shigure
Author-email: sigure.qaq@gmail.com
Requires-Python: >=3.7,<4.0
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Provides-Extra: paddle
Requires-Dist: paddlepaddle (>=2.1.2,<3.0.0); extra == "paddle"
Project-URL: Bug Tracker, https://github.com/cattidea/paddle-toolbox/issues
Project-URL: Repository, https://github.com/cattidea/paddle-toolbox
Description-Content-Type: text/markdown

# Paddle Toolbox [WIP]

ä¸€äº›æ–¹ä¾¿çš„å°å·¥å…·ï¼Œå‚è€ƒ Paddle çš„ API è®¾è®¡ä»¥åŠ Torch Toolbox API è®¾è®¡

## å®‰è£…

### ä½¿ç”¨ pip å®‰è£…

```bash
pip install pptb
```

ç”±äºä»å¤„äºå¼€å‘é˜¶æ®µï¼ŒAPI è¾ƒä¸ºä¸ç¨³å®šï¼Œå»ºè®®å®‰è£…æ—¶æŒ‡å®šç‰ˆæœ¬å·

```bash
pip install pptb==0.1.4
```

### ç›´æ¥ä» GitHub æ‹‰å–æœ€æ–°ä»£ç 

è¿™é‡Œä»¥ AiStudio ä¸ºä¾‹

```bash
git clone https://github.com/cattidea/paddle-toolbox.git work/paddle-toolbox/
# å¦‚æœä¸‹è½½å¤ªæ…¢å¯¼è‡´å‡ºé”™è¯·ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤
# git clone https://hub.fastgit.org/cattidea/paddle-toolbox.git work/paddle-toolbox/
```

ä¹‹ååœ¨ä½ çš„ Notebook æˆ–è€… Python æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹ä»£ç 

```python
import sys

sys.path.append('/home/aistudio/work/paddle-toolbox/')
```

## å·²æ”¯æŒçš„å·¥å…·

### LabelSmoothingLoss

```python
import paddle
from pptb.nn import LabelSmoothingLoss

num_classes = 40
label_smooth_epision = 0.1

# å¦‚æœéœ€è¦æ ‡ç­¾å¹³æ»‘å Lossï¼Œå°†ä¸‹é¢è¿™è¡Œæ›¿æ¢æˆåé¢é‚£ä¸€è¡Œå³å¯
# loss_function = paddle.nn.CrossEntropyLoss()
loss_function = LabelSmoothingLoss(paddle.nn.CrossEntropyLoss(soft_label=True), num_classes, label_smooth_epision)
```

### CosineWarmup

```python
import paddle
from pptb.optimizer.lr import CosineWarmup

# ...

train_batch_size = 32
learning_rate = 3e-4
step_each_epoch = len(train_set) // train_batch_size
num_epochs = 40
warmup_epochs = 3

lr_scheduler = CosineWarmup(
    learning_rate,
    total_steps = num_epochs * step_each_epoch,
    warmup_steps = warmup_epochs * step_each_epoch,
    warmup_start_lr = 0.0,
    cosine_end_lr = 0.0,
    last_epoch = -1
)

```

### Mixup

```python
import paddle
from pptb.tools import mixup_data, mixup_criterion, mixup_metric

# ...

use_mixup = True
mixup_alpha = 0.2

for X_batch, y_batch in train_loader():
   # ä½¿ç”¨ mixup ä¸ä¸ä½¿ç”¨ mixup ä»£ç çš„å‰å‘ä¼ æ’­éƒ¨åˆ†ä»£ç å·®å¼‚å¯¹æ¯”
   if use_mixup:
      X_batch_mixed, y_batch_a, y_batch_b, lam = mixup_data(X_batch, y_batch, mixup_alpha)
      predicts = model(X_batch_mixed)
      loss = mixup_criterion(loss_function, predicts, y_batch_a, y_batch_b, lam)
      acc = mixup_metric(paddle.metric.accuracy, predicts, y_batch_a, y_batch_b, lam)
   else:
      predicts = model(X_batch)
      loss = loss_function(predicts, y_batch)
      acc = paddle.metric.accuracy(predicts, y_batch)

   # ...
```

### Vision models

æä¾›æ›´åŠ ä¸°å¯Œçš„ backboneï¼Œæ‰€æœ‰æ¨¡å‹å‡ä¼šæä¾›é¢„è®­ç»ƒæƒé‡

å·²æ”¯æŒä¸€äº› PaddleClas ä¸‹çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œä»¥åŠæ¯”è¾ƒæ–°çš„ ConvMixer

-  GoogLeNet
-  Incetpionv3ï¼ˆå·²å¹¶å…¥ paddle ä¸»çº¿ï¼‰
-  ResNeXtï¼ˆå·²å¹¶å…¥ paddle ä¸»çº¿ï¼‰
-  ShuffleNetV2
-  ConvMixerï¼ˆé¢„è®­ç»ƒæƒé‡è½¬è‡ª PyTorchï¼‰
-  DenseNet (æœªå®Œæ•´æ”¯æŒ)

```python
import paddle
import pptb.vision.models as ppmodels

model = ppmodels.resnext50_32x4d(pretrained=True)
```

PS: å¦‚æœè¿™äº›æ¨¡å‹æ— æ³•æ»¡è¶³ä½ çš„éœ€æ±‚çš„è¯ï¼Œå¯ä»¥è¯•è¯•å›Šæ‹¬äº†å¾ˆå¤šæ¯”è¾ƒæ–°çš„æ¨¡å‹çš„ [ppim](https://github.com/AgentMaker/Paddle-Image-Models)~

#### ConvMixer

| Model Name                | Kernel Size | Patch Size | Top-1                                                 | Top-5  |
| ------------------------- | ----------- | ---------- | ----------------------------------------------------- | ------ |
| convmixer_768_32          | 7           | 7          | 0.7974<span style="color:green;"><sub>(-0.0042)</sub> | 0.9486 |
| convmixer_1024_20_ks9_p14 | 9           | 14         | 0.7681<span style="color:green;"><sub>(-0.0013)</sub> | 0.9335 |
| convmixer_1536_20         | 9           | 7          | 0.8083<sub><span style="color:green;">(-0.0054)</sub> | 0.9557 |

### TODO List

ä¸€äº›è¿‘æœŸæƒ³åšçš„åŠŸèƒ½

-  [ ] Cutout
-  [ ] Activationã€Mish
-  [ ] ~~Lookahead (paddle.incubate.LookAhead å·²ç»æœ‰äº†)~~
-  [ ] æ›´å¤š vision models
   -  [ ] MobileNetV3
   -  [ ] Xception
   -  [ ] Swin Transformer
   -  [ ] DenseNetï¼ˆå®Œæ•´æ”¯æŒï¼‰
-  [ ] å®Œæ•´çš„å•å…ƒæµ‹è¯•

## References

-  [PaddlePaddle](https://github.com/PaddlePaddle/Paddle)
-  [Torch Toolbox](https://github.com/PistonY/torch-toolbox)

