---
include:
  - nav.yml
---
variable name: mandatory_packages
data:
  "https://github.com/SuffolkLITLab/docassemble-ALToolbox":
    label: ALToolbox
    help: |
      Utility functions and web components that may help with or without the
      Assembly Line framework.
  "https://github.com/SuffolkLITLab/docassemble-AssemblyLine":
    label: Assembly Line (Core)
    help: |
      The core Assembly Line runtime code, with default styling.
---
variable name: optional_packages
data:
  "https://github.com/SuffolkLITLab/docassemble-ALWeaver":
    label: ALWeaver
    help: |
      A tool to help turn templates into draft interviews quickly.
  "https://github.com/SuffolkLITLab/docassemble-InterviewStats/":
    label: InterviewStats
    help: |
      A package to help view detailed statistics generated by 
      store_interview_snapshot() (created by default just before
      download for all Assembly Line packages)
  "https://github.com/SuffolkLITLab/docassemble-ALMassachusetts":
    label: Massachusetts-specific questions
  "https://github.com/SuffolkLITLab/docassemble-MassAccess":
    label: |
      Mass Access / Court Forms Online branding
    help: |
      Logo and branding for Court Forms Online / Suffolk LIT Lab
  "https://github.com/SuffolkLITLab/docassemble-ALDashboard":
    label: ALDashboard
    help: |
      A menu and dashboard for small administrative tasks
  "https://github.com/SuffolkLITLab/docassemble-EFSPIntegration/":
    label: E-filing client
    help: |
      E-filing client for Tyler EFM
---
comment: |
  manage_api
  
  from docassemble.webapp.daredis import r, r_user
---
modules:
  - .aldashboard
---
mandatory: True
code: |
  selected_mandatory_packages
  al_install_done
  end_screen
---
code: |
  for pkg_url in selected_mandatory_packages.true_values() + selected_optional_packages.true_values():
    pkgname = install_from_github_url(pkg_url)
  reset(pkgname)
  al_install_done = True
---
question: |
  What packages do you want to install or update?  
fields:
  - Core packages: selected_mandatory_packages
    datatype: checkboxes
    code: |
      [{key: mandatory_packages[key].get('label'), "help": mandatory_packages[key].get('help')} for key in mandatory_packages]
    default:
      - https://github.com/SuffolkLITLab/docassemble-ALToolbox
      - https://github.com/SuffolkLITLab/docassemble-AssemblyLine
    none of the above: False      
  - Optional packages: selected_optional_packages
    datatype: checkboxes
    code: |
      [{key: optional_packages[key].get('label'), "help": optional_packages[key].get('help')} for key in optional_packages]  
    none of the above: False      
---
event: end_screen
question: |
  Installation complete
subquestion: |
  Check the status in the [Package management page](/updatepackage)
  
  