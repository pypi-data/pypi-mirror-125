(self.webpackChunk=self.webpackChunk||[]).push([[944],{37077:(e,t,a)=>{"use strict";var n,r=a(63025),o=a(32735),s=a(12788),i=a(89178),l=a(28995);function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){(0,i.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}(n=window).setupCategoryDisplaySubcatList=function(){const e=$(".category-list").data("subcat-info-url");void 0!==e&&$.ajax({url:e,dataType:"json",success(e){Object.entries(e.event_counts).forEach((e=>{let[t,a]=e;const n=a.value?l.$T.ngettext("{0} event","{0} events",a.value).format(a.pretty):l.$T.gettext("empty");$(`#category-event-count-${t}`).text(n)}))}})},n.setupCategoryDisplayEventList=function(e,t,a,n){const r=$(".event-list"),o=r.find(".future-events"),s=r.find(".past-events");function i(e,t){const a=$(e),r=a.find(".events");function o(e){a.find(".js-hide-message").toggle(e),a.find(".js-show-message").toggle(!e)}function s(e){a.find(".js-toggle-list").toggle(!e),a.find(".js-spinner").toggle(e)}o(!r.is(":empty")),s(!1),a.find(".js-toggle-list").on("click",(function(e,a){let i;e.preventDefault(),r.is(":empty")?(i=!0,s(!0),$.ajax({url:r.data("event-list-url"),data:u({before:r.data("event-list-before"),after:r.data("event-list-after")},n),error:handleAjaxError,success(e){r.html(e.html),r.show(),o(!0),s(!1)}})):r.is(":visible")?(i=!1,r.hide(),o(!1)):(i=!0,r.show(),o(!0)),!a&&t&&t(i)}))}a&&(n.flat=1),i(o,(function(e){a||$.ajax({url:r.data("show-future-events-url"),method:e?"PUT":"DELETE",error:handleAjaxError})})),i(s,(function(e){a||$.ajax({url:r.data("show-past-events-url"),method:e?"PUT":"DELETE",error:handleAjaxError})})),e&&!a&&o.find(".js-toggle-list").first().trigger("click",!0),t&&!a&&s.find(".js-toggle-list").first().trigger("click",!0)},n.setupCategoryDisplay=function(){$(".fav-button").on("click",(function(){const e=$(this),t=e.hasClass("enabled");e.prop("disabled",!0),$.ajax({url:e.data("href"),method:t?"DELETE":"PUT",error:handleAjaxError,success(){e.toggleClass("enabled",!t)},complete(){e.prop("disabled",!1)}})})).qtip({hide:{fixed:!0,delay:500},content:{text(){const e=$(this);return e.hasClass("enabled")?l.$T.gettext("Remove from your favorites"):"<h3>{0}</h3><p>{1}</p>".format(l.$T.gettext("Add to your favorites"),l.$T.gettext('This will make events in this category visible on your <a href="{0}">Dashboard</a>.').format(e.data("favorites-href")))}}})};var d=a(44035),m=a(19306);document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#category-calendar-link");if(!e)return;const t=e.dataset.categoryId;s.render(o.createElement(d.Os,{endpoint:"categories.export_ical",params:{category_id:t},renderButton:e=>o.createElement(d.Lp,{icon:"calendar",classes:e}),options:[{key:"category",text:m.vN.string("Category"),extraParams:{}}]}),e)}));var g=a(50340),f=a(53806),y=a.n(f),v=a(60216),p=a.n(v),b=a(3047),E=a(41612),h=a(34598),_=a(19855),j=a(53130),Z=a(25899),D=a(4925),x=a(43146);const C=o.createContext(null),O=r.ZP.bind(null,{endpoint:"categories.statistics_json",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"statistics.json",isDynamic:!1}]}]},"/");function N(e){let{categoryId:t}=e;const{data:a,loading:n}=(0,x.K3)({url:O({category_id:t}),camelize:!0,trigger:t});return n?o.createElement(E.Z,{size:"massive",active:!0}):a?o.createElement(w,{data:a}):null}function w(e){let{data:t}=e;const a=(0,o.useContext)(C).replace("_","-"),n=y().utc(t.updated).local().format("LLL"),r=new Intl.NumberFormat(a),s=r.format(t.totalEvents),i=r.format(t.totalContributions),l=r.format(t.files),c=r.format(t.users),{eventGraph:u,contributionsGraph:d,series:g,axes:f,tooltip:v}=(0,o.useMemo)((()=>function(e){const t=t=>{const a=parseInt(Object.keys(t).reverse().find((t=>t<=e.maxYear+3)),10);return[[y()(e.minYear-1,"YYYY"),null],...Object.entries(t).filter((t=>{let[n]=t;return n<=a&&n>=e.minYear})).map((e=>{let[t,a]=e;return[y()(t,"YYYY"),a]})),[y()(a+1,"YYYY"),null]]};return{eventGraph:[{label:m.vN.string("Events"),data:t(e.events)}],contributionsGraph:[{label:m.vN.string("Contributions"),data:t(e.contributions)}],series:{type:"bar"},axes:[{primary:!0,type:"time",position:"bottom"},{type:"linear",position:"left"}],tooltip:{align:"left",anchor:"left"}}}(t)),[t]);return o.createElement(h.Z,null,o.createElement(_.Z.Group,{horizontal:!0},o.createElement(_.Z,null,o.createElement(j.Z,{as:"h2"},o.createElement(j.Z.Content,null,o.createElement(m.vN,null,"Number of events"),o.createElement(j.Z.Subheader,null,o.createElement(m.vN,null,"The year is the one of the start date of the event.")))),o.createElement(_.Z,{basic:!0},0===u[0].data.length?o.createElement(Z.Z,{info:!0},o.createElement(m.vN,null,"No data available")):o.createElement("div",{className:"categories-client-js-components-___CategoryStatistics-module__chart-container___k7Hc3"},o.createElement(b.Chart,{className:"categories-client-js-components-___CategoryStatistics-module__chart___33CDu",data:u,series:g,axes:f,tooltip:v})))),o.createElement(_.Z,null,o.createElement(j.Z,{as:"h2"},o.createElement(j.Z.Content,null,o.createElement(m.vN,null,"Number of contributions"),o.createElement(j.Z.Subheader,null,o.createElement(m.vN,null,"The year is the one of the start date of the contribution.")))),o.createElement(_.Z,{basic:!0},0===d[0].data.length?o.createElement(Z.Z,{info:!0},o.createElement(m.vN,null,"No data available")):o.createElement("div",{className:"categories-client-js-components-___CategoryStatistics-module__chart-container___k7Hc3"},o.createElement(b.Chart,{className:"categories-client-js-components-___CategoryStatistics-module__chart___33CDu",data:d,series:g,axes:f,tooltip:v}))))),o.createElement(_.Z.Group,{horizontal:!0},o.createElement(_.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(D.Z,{inverted:!0},o.createElement(D.Z.Value,null,s),o.createElement(D.Z.Label,null,o.createElement(m.vN,null,"Total number of events")))),o.createElement(_.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(D.Z,{inverted:!0},o.createElement(D.Z.Value,null,i),o.createElement(D.Z.Label,null,o.createElement(m.vN,null,"Total number of contributions")))),o.createElement(_.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(D.Z,{inverted:!0},o.createElement(D.Z.Value,null,l),o.createElement(D.Z.Label,null,o.createElement(m.vN,null,"Number of attachments")))),void 0!==t.users&&o.createElement(_.Z,{inverted:!0,color:"blue",textAlign:"center"},o.createElement(D.Z,{inverted:!0},o.createElement(D.Z.Value,null,c),o.createElement(D.Z.Label,null,o.createElement(m.vN,null,"Number of users"))))),o.createElement(m.vN,null,"Last updated on: ",o.createElement(m.dO,{name:"time",value:n})))}N.propTypes={categoryId:p().number.isRequired},w.propTypes={data:p().shape({contributions:p().object.isRequired,events:p().object.isRequired,files:p().number.isRequired,updated:p().string.isRequired,users:p().number,totalEvents:p().number.isRequired,totalContributions:p().number.isRequired,minYear:p().number.isRequired,maxYear:p().number.isRequired}).isRequired};const L=r.ZP.bind(null,{endpoint:"search.category_search",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"search",isDynamic:!1}]}]},"/"),T=r.ZP.bind(null,{endpoint:"search.search",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");!function(e){document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#search-box");if(e){const t=JSON.parse(e.dataset.category),a=void 0!==e.dataset.isAdmin;s.render(o.createElement(g.Z,{onSearch:(e,n,r)=>{const o={q:e};a&&r&&(o.admin_override_enabled=!0),n?window.location=T(o):(o.category_id=t.id,window.location=L(o))},category:t,isAdmin:a}),e)}})),e.setupCategoryStats=function(){document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#category-stats-root");if(!e)return;const t=parseInt(e.dataset.categoryId,10),a=e.dataset.lang;s.render(o.createElement(C.Provider,{value:a},o.createElement(N,{categoryId:t})),e)}))}}(window)}},e=>{"use strict";e.O(0,[5514,3044,8592],(()=>{return t=37077,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_categories.b6d9a0f1.bundle.js.map